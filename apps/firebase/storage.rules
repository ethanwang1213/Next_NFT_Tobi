rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /users/{userId} {
      allow read: if true;
      match /icon/{fileName} {
        allow read: if true;
        allow write: if request.auth != null 
        	&& request.auth.uid == userId 
          && (
            request.resource == null
            || (
              request.resource.size < 10 * 400 * 400
              && request.resource.contentType == "image/png"
          	)
        	);
      }
      match /item/{itemId}/{fileName} {
        allow read: if true;
        allow write: if request.auth != null 
        	&& request.auth.uid == userId
          && request.resource.size < 10 * 1024 * 1024
          && (fileName == 'image.png' || fileName == 'model.glb');
      }
      match /tcp/copyright/files/{fileName} {
        allow read: if true;
        allow write: if request.auth != null
          && request.auth.uid == userId
          && request.resource.size < 20 * 1024 * 1024
          && request.resource.contentType.matches('image/jpeg|image/png|application/pdf');
      }
    }
  }
}